// ==========================================================================
// Project:   Ember - JavaScript Application Framework
// Copyright: ©2011-2013 Tilde Inc. and contributors
//            Portions ©2006-2011 Strobe Inc.
//            Portions ©2008-2011 Apple Inc. All rights reserved.
// License:   Licensed under MIT license
//            See https://raw.github.com/emberjs/ember.js/master/LICENSE
// ==========================================================================


// Last commit: c72e6a8 (2013-08-31 12:32:15 -0700)


!function(){var t,e;!function(){var n={},i={};t=function(t,e,i){n[t]={deps:e,callback:i}},e=function(t){if(i[t])return i[t];i[t]={};var r,s,a,o,h;if(r=n[t],!r)throw new Error("Module '"+t+"' not found.");s=r.deps,a=r.callback,o=[];for(var u=0,c=s.length;c>u;u++)"exports"===s[u]?o.push(h={}):o.push(e(s[u]));var l=a.apply(this,o);return i[t]=h||l}}(),function(){var t=Ember.get,e=Ember.set;Ember.State=Ember.Object.extend(Ember.Evented,{parentState:null,start:null,name:null,path:Ember.computed(function(){var e=t(this,"parentState.path"),n=t(this,"name");return e&&(n=e+"."+n),n}),trigger:function(t){this[t]&&this[t].apply(this,[].slice.call(arguments,1)),this._super.apply(this,arguments)},init:function(){var n=t(this,"states");e(this,"childStates",Ember.A()),e(this,"eventTransitions",t(this,"eventTransitions")||{});var i,r,s;if(n)for(i in n)this.setupChild(n,i,n[i]);else{n={};for(i in this)"constructor"!==i&&(r=this[i])&&((s=r.transitionTarget)&&(this.eventTransitions[i]=s),this.setupChild(n,i,r));e(this,"states",n)}e(this,"pathsCaches",{})},setPathsCache:function(e,n,i){var r=Ember.guidFor(e.constructor),s=t(this,"pathsCaches"),a=s[r]||{};a[n]=i,s[r]=a},getPathsCache:function(e,n){var i=Ember.guidFor(e.constructor),r=t(this,"pathsCaches"),s=r[i]||{};return s[n]},setupChild:function(n,i,r){if(!r)return!1;var s;return r instanceof Ember.State?(e(r,"name",i),s=r,s.container=this.container):Ember.State.detect(r)&&(s=r.create({name:i,container:this.container})),s instanceof Ember.State?(e(s,"parentState",this),t(this,"childStates").pushObject(s),n[i]=s,s):void 0},lookupEventTransition:function(t){for(var e,n=this;n&&!e;)e=n.eventTransitions[t],n=n.get("parentState");return e},isLeaf:Ember.computed(function(){return!t(this,"childStates").length}),hasContext:!0,setup:Ember.K,enter:Ember.K,exit:Ember.K}),Ember.State.reopenClass({transitionTo:function(t){var e=function(e,n){var i=[],r=Ember.$&&Ember.$.Event;n&&r&&n instanceof r?n.hasOwnProperty("contexts")&&(i=n.contexts.slice()):i=[].slice.call(arguments,1),i.unshift(t),e.transitionTo.apply(e,i)};return e.transitionTarget=t,e}})}(),function(){var t=Ember.get,e=Ember.set,n=Ember.String.fmt,i=Ember.ArrayPolyfills.forEach,r=function(t){this.enterStates=t.enterStates.slice(),this.exitStates=t.exitStates.slice(),this.resolveState=t.resolveState,this.finalState=t.enterStates[t.enterStates.length-1]||t.resolveState};r.prototype={normalize:function(t,e){return this.matchContextsToStates(e),this.addInitialStates(),this.removeUnchangedContexts(t),this},matchContextsToStates:function(e){for(var n,i,r=this.enterStates.length-1,s=[];e.length>0;){if(r>=0)n=this.enterStates[r--];else{if(this.enterStates.length){if(n=t(this.enterStates[0],"parentState"),!n)throw"Cannot match all contexts to states"}else n=this.resolveState;this.enterStates.unshift(n),this.exitStates.unshift(n)}i=t(n,"hasContext")?e.pop():null,s.unshift(i)}this.contexts=s},addInitialStates:function(){for(var e,n=this.finalState;;){if(e=t(n,"initialState")||"start",n=t(n,"states."+e),!n)break;this.finalState=n,this.enterStates.push(n),this.contexts.push(void 0)}},removeUnchangedContexts:function(t){for(;this.enterStates.length>0&&this.enterStates[0]===this.exitStates[0];){if(this.enterStates.length===this.contexts.length){if(t.getStateMeta(this.enterStates[0],"context")!==this.contexts[0])break;this.contexts.shift()}this.resolveState=this.enterStates.shift(),this.exitStates.shift()}}};var s=function(e,i,r){var o,h,u,c=this.enableLogging,l=r?"unhandledEvent":e,f=i[l];if(o=[].slice.call(arguments,3),"function"==typeof f)return c&&(r?Ember.Logger.log(n("STATEMANAGER: Unhandled event '%@' being sent to state %@.",[e,t(i,"path")])):Ember.Logger.log(n("STATEMANAGER: Sending event '%@' to state %@.",[e,t(i,"path")]))),u=o,r&&u.unshift(e),u.unshift(this),f.apply(i,u);var S=t(i,"parentState");return S?(h=o,h.unshift(e,S,r),s.apply(this,h)):r?void 0:a.call(this,e,o,!0)},a=function(e,n,i){return n.unshift(e,t(this,"currentState"),i),s.apply(this,n)};Ember.StateManager=Ember.State.extend({init:function(){this._super(),e(this,"stateMeta",Ember.Map.create());var n=t(this,"initialState");!n&&t(this,"states.start")&&(n="start"),n&&this.transitionTo(n)},stateMetaFor:function(e){var n=t(this,"stateMeta"),i=n.get(e);return i||(i={},n.set(e,i)),i},setStateMeta:function(t,n,i){return e(this.stateMetaFor(t),n,i)},getStateMeta:function(e,n){return t(this.stateMetaFor(e),n)},currentState:null,currentPath:Ember.computed.alias("currentState.path"),transitionEvent:"setup",errorOnUnhandledEvent:!0,send:function(t){var e=[].slice.call(arguments,1);return a.call(this,t,e,!1)},unhandledEvent:function(e,n){if(t(this,"errorOnUnhandledEvent"))throw new Ember.Error(this.toString()+" could not respond to event "+n+" in state "+t(this,"currentState.path")+".")},getStateByPath:function(e,n){for(var i=n.split("."),r=e,s=0,a=i.length;a>s&&(r=t(t(r,"states"),i[s]),r);s++);return r},findStateByPath:function(e,n){for(var i;!i&&e;)i=this.getStateByPath(e,n),e=t(e,"parentState");return i},getStatesInPath:function(e,n){if(!n||""===n)return void 0;for(var i,r,s=n.split("."),a=[],o=0,h=s.length;h>o;o++){if(i=t(e,"states"),!i)return void 0;if(r=t(i,s[o]),!r)return void 0;e=r,a.push(r)}return a},goToState:function(){return this.transitionTo.apply(this,arguments)},transitionTo:function(e,n){if(!Ember.isEmpty(e)){var i=n?Array.prototype.slice.call(arguments,1):[],s=t(this,"currentState")||this,a=this.contextFreeTransition(s,e),o=new r(a).normalize(this,i);this.enterState(o),this.triggerSetupContext(o)}},contextFreeTransition:function(e,n){var i=e.getPathsCache(this,n);if(i)return i;for(var r=this.getStatesInPath(e,n),s=[],a=e;a&&!r;){if(s.unshift(a),a=t(a,"parentState"),!a&&(r=this.getStatesInPath(this,n),!r))return;r=this.getStatesInPath(a,n)}for(;r.length>0&&r[0]===s[0];)a=r.shift(),s.shift();var o={exitStates:s,enterStates:r,resolveState:a};return e.setPathsCache(this,n,o),o},triggerSetupContext:function(e){var n=e.contexts,r=e.enterStates.length-n.length,s=e.enterStates,a=t(this,"transitionEvent");i.call(s,function(t,e){t.trigger(a,this,n[e-r])},this)},getState:function(e){var n=t(this,e),i=t(this,"parentState");return n?n:i?i.getState(e):void 0},enterState:function(n){var r=this.enableLogging,s=n.exitStates.slice(0).reverse();i.call(s,function(t){t.trigger("exit",this)},this),i.call(n.enterStates,function(e){r&&Ember.Logger.log("STATEMANAGER: Entering "+t(e,"path")),e.trigger("enter",this)},this),e(this,"currentState",n.finalState)}})}()}(),"undefined"==typeof location||"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname||Ember.Logger.warn("You are running a production build of Ember on localhost and won't receive detailed error messages. If you want full error messages please use the non-minified build provided on the Ember website.");